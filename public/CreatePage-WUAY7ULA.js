import{a as w}from"./chunk-T2BU323Z.js";import"./chunk-S6LVBEUU.js";import{a as P}from"./chunk-D4RARUUX.js";import{a as D}from"./chunk-FDL32AD7.js";import{a as d}from"./chunk-GFLQL2OI.js";import"./chunk-AVVFLK4W.js";import{d as b}from"./chunk-F5BNY5M6.js";import"./chunk-MLLMWUDP.js";import"./chunk-XCKYJCSI.js";import"./chunk-M5VJKR3C.js";import{a as f}from"./chunk-G27EFIGX.js";import"./chunk-FXRGY3TF.js";import{i as C,j as T}from"./chunk-BGUH4UV6.js";import{a as p,b as g,d as L,f as I}from"./chunk-DRMASW6M.js";var t=L(I());var x=class{static async formSubmit({data:o,setAlert:i,setErrors:r,navigate:n,setSubmitLoading:a}){if(i!==null)if(this.isFormValid(o,r)){a(!0);try{let{currentUser:e}=C();if(e){let c=g(p({},o),{creatorName:e.displayName,creatorUID:e.uid}),u=await D.create(c);await D.updateLatestProducts(u);let l=await f.get(e.uid);l.products.push(g(p({},c),{productUID:u.productUID})),await f.updateDB(e.uid,l),n("/products",{replace:!1}),i({message:"Created product campaign!",type:"success"})}else throw new Error("Missing current user.")}catch(e){i({message:e.message,type:"error"})}a(!1)}else i({message:"Form data invalid.",type:"error"})}static isFormValid(o,i){let{title:r,goal:n,description:a}=o,e={title:!1,goal:!1,description:!1};return r&&a&&n?((r.length<3||r.length>32)&&(e.title=!0),(n.length>12||!/^[+-]?[0-9]{1,3}(?:,?[0-9]{3})*(?:\.[0-9]{2})?$/.test(n))&&(e.goal=!0),a.length>T.PRODUCT_DESCRIPTION_MAXLENGTH&&(e.description=!0),i(e),!(e.title||e.goal||e.description)):!1}},S=x;var B=()=>{let{setAlert:h}=(0,t.useContext)(P),[o,i]=(0,t.useState)(""),[r,n]=(0,t.useState)(""),[a,e]=(0,t.useState)(""),[c,u]=(0,t.useState)({title:o,goal:r,description:a}),[l,v]=(0,t.useState)({title:!1,goal:!1,description:!1}),[y,F]=(0,t.useState)(!0),[N,E]=(0,t.useState)(!1),U=b();(0,t.useEffect)(()=>{let s={title:o.trim(),goal:r.trim().replace(/,/g,""),description:a};u(s);let A=S.isFormValid(s,v);F(!A)},[o,r,a]);let m={title:"Must be between 3-32 characters",goal:"Please input a valid USD amount less than 12 numbers long",description:"Tell us about your product within 2,000 words"};return t.default.createElement("div",null,t.default.createElement("h2",null,"Create Campaign"),t.default.createElement("div",{className:"form-container"},t.default.createElement(d,{id:"title-input",helperText:m.title,label:"Campaign Title",error:l.title,value:o,onChange:({target:s})=>i(s.value),required:!0}),t.default.createElement(d,{id:"goal-input",helperText:m.goal,label:"Funding Goal in USD",error:l.goal,value:r,onChange:({target:s})=>n(s.value),required:!0}),t.default.createElement(d,{id:"description-input",helperText:m.description,label:"Campaign Description",multiline:!0,rows:8,error:l.description,value:a,onChange:({target:s})=>e(s.value)}),t.default.createElement(w,{variant:"contained",loading:N,onClick:()=>S.formSubmit({data:c,setAlert:h,setErrors:v,navigate:U,setSubmitLoading:E}),disabled:y},"Create")))},$=B;export{$ as default};
